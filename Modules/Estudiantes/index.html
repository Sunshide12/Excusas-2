<!DOCTYPE html>
<html lang="es">
  <head>
    <!-- Configuración básica del documento HTML -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Importación de Bootstrap 5.3.2 para el diseño responsivo -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    
    <!-- Favicon de la institución -->
    <link rel="icon" type="image/x-icon" href="/Images/favicon.ico" />
    <link rel="shortcut icon" type="image/x-icon" href="/Images/favicon.ico" />
    
    <!-- Hoja de estilos personalizada para el módulo de estudiantes -->
    <link rel="stylesheet" href="../../CSS/estudiante/index.css" />
    
    <title>Ingreso Estudiantes</title>
  </head>

  <body>
    <!-- Panel principal del formulario de login -->
    <div class="panel">
      <!-- Imagen de fondo izquierda -->
      <img src="../../Images/login.jpg" alt="Imagen" class="main-image" />
      
      <!-- Texto informativo sobre campos obligatorios -->
      <div class="footer-text1">
        * Campos obligatorios
        <br /><br />
      </div>
      
      <!-- Pie de página con información de derechos de autor -->
      <div class="footer-text2">
        <br />
        Corporación de Estudios Tecnológicos del Norte del Valle © Todos los
        Derechos Reservados
      </div>

      <!-- Formulario de autenticación para estudiantes -->
      <form id="loginForm" class="form">
        <!-- Logo institucional -->
        <img src="/Images/favicon.ico" alt="Logo" class="logo" />

        <!-- Título del formulario -->
        <div id="id_ajax_label_titulo">Ingreso Consultas Estudiante</div>

        <!-- Campo para documento de identidad -->
        <label for="documentoIdentidad">Documento de identidad *</label>
        <input
          type="text"
          name="documentoIdentidad"
          id="documentoIdentidad"
          class="form-control"
        />

        <!-- Campo para contraseña -->
        <label for="contrasena" class="mt-3">Contraseña *</label>
        <input
          type="password"
          name="contrasena"
          id="contrasena"
          class="form-control"
        />

        <!-- Enlace para recuperación de contraseña -->
        <a href="#" class="forgot-link"
          >¿Has olvidado tu contraseña o aún no la tienes?</a
        >

        <!-- Contenedor para mensajes de error (inicialmente oculto) -->
        <div
          id="mensajeError"
          class="alert alert-danger"
          style="display: none"
        ></div>

        <!-- Botón de envío del formulario -->
        <button type="submit" class="btn btn-success" id="btnIngresar">
          Ingresar
        </button>
      </form>
    </div>

    <!-- Importación de Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Script principal para el manejo del formulario de login -->
    <script>
      // Event listener para el envío del formulario de login
      document
        .getElementById("loginForm")
        .addEventListener("submit", function (e) {
          e.preventDefault(); // Prevenir envío tradicional del formulario
          
          // Crear objeto FormData con los datos del formulario
          const formData = new FormData(this);
          
          // Realizar petición AJAX al API de login de estudiantes
          fetch("../../php/login_estudiante_api.php", {
            method: "POST",
            body: formData,
          })
            .then((response) => response.json()) // Convertir respuesta a JSON
            .then((data) => {
              if (data.success) {
                // Si el login es exitoso, redirigir al panel principal
                window.location.href = "Principal.php";
              } else {
                // Si hay error, mostrar mensaje en el contenedor de errores
                const mensajeError = document.getElementById("mensajeError");
                mensajeError.textContent = data.mensaje;
                mensajeError.style.display = "block";
              }
            })
            .catch((error) => {
              // Manejo de errores de red o del servidor
              console.error("Error:", error);
              const mensajeError = document.getElementById("mensajeError");
              mensajeError.textContent = "Error al intentar iniciar sesión";
              mensajeError.style.display = "block";
            });
        });
    </script>
    
    <!-- Script adicional para funcionalidades del módulo -->
    <script src="js/main.js"></script>
  </body>
</html>
